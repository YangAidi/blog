# 杨爱迪的测试博客 v-0.1
测试地址 [http://www.xinshenwoyaoxue.com:9000/html/index.html][1]
> - 兼容性方面目前EDGE正常，但是chrome我这边可能因为有缓存的原因，css文件js文件加载异常。

##### 终于是把第一个版本做出来了，历尽千辛万苦，特别是前端方面的遇到的一些问题（主要是因为自己太菜了，之前完全没有写过JS的东西）。后端全部是由自己完成，前端页面中CSS大多是“借鉴的”别人的，JS文件全部都是自己写的。


----------

因为自己的初衷是搭建一个前后端完全分离的网站，后端的定位 **只提供API** ，其他的都由前端完成。但是自己的js水平实在是太差，遇到了一个接着一个的问题。先在这记录一下遇到的一些问题吧，有时间再补充一些真正的ReadMe文档吧。

## 问题合辑 ##
 - 首先是**JS使用**上吧，之前JS水平仅限于读别人的代码，这里我并没有使用一些成熟的前端框架，所以无论是API的调用还是页面的刷新，都是靠着自己一条一条强行撸出来的，各种JQUERY和AJAX也是混着用，所以前端代码的可读性真的有待提高。尝试着把js文件分离出来，但是又牵涉到互相引用的问题，所以目前还是维持现状吧，有机会整理下。

 - **跨域请求**的问题，因为我这是前后端完全分离，所以前后端可能不在同一个域名下（应该肯定会出现的，因为后端和前端正常是不会出现在一个端口的，这算做两个域名）解决方案想到了两个，一个是通过nginx来转发，即前端和后台API的请求都映射到一台nginx上面，然后通过nginx来讲二者区分开来，分别调用不同的服务。还有一种比较简单的解决方案是在后端加上 CorsRegistry 来实现一个拦截器的功能。

 - 跳转页面后**session重新刷新的问题**，比如当点击登录等按钮时，自己是直接把页面跳转到了另外一个页面，其他页面再去调用是否登录这个按钮时，总是显示未登录。后来终于搞明白了，是因为每次通过跳转新打开一个页面，其实都是相当于和后端服务器新建了一个会话，新会话当然是没有登录的。后端对于会话的另一方是谁，其实就是根据浏览器发过来的jsessionid来判断的（相当于一个短时间的token）。一般浏览器都是不允许用户去自己编辑jsessionid的，不知道前端框架是怎么实现的（或者我的想法本来就是错误的？）。建立在这种想法上，我的实现方式是登陆之后后端把他的jsessionid返回给前端，然后前端把它存储在Cookie里面，等下一个页面再次去请求API时，把这个jsessionid附加上面，“模拟”成之前那一个用户，这种思想和很多token识别机制相似。

 - **RequestBody不能直接影射成Model**的问题，因为JQUERY post方式的contentType只支持 application/x-www-form-urlencoded;charset=utf-8格式，所以不能使用RequestBody直接影射成model，只好自己写Map再转换了。不过后来自己看了AJAX之后这就不是问题了，因为AJAX可以指定传输的类型啊！！！

 - **nginx静态资源加载问题**，这个算是迄今为止卡的时间最长的问题吧，本来以为大功告成，在本地调试一切顺利，界面大体上也ok，但是当我部署到服务器上面发给其他人看时傻眼了，css、js、图片文件都加载不出来，后来才知道应该在nginx配置静态资源的监听。然后自己又因为自己加载css、js时用的都是相对路径，类似于 ../js/1.js 这种，所以配置的时候很蛋疼，不知道能不能真的读取到（其实这是我的白担心，是能读取到的），但是无论自己怎么修改nginx配置，始终都是加载不了css和js文件，后来在知乎上找到了个答案，
> 关于google chrome 的 Resource interpreted as stylesheet but transferred with MIME type text/plain问题? - 金晓晴的回答 - 知乎
https://www.zhihu.com/question/20180840/answer/222704316

卧槽，印象中，自己好像也是报的这个错误，删了试试，不行，界面还是没有css，但是什么情况？？？这个错误还在报，那一段代码我都删了！！！这时候自己意识到，chrome里面显示的这段代码是旧的，换到EDGE上面，果然，没问题，css、js加载正常。其实自己早就配置对了，问题出在了chrome里面的缓存一直都是旧的，但是尝试着清楚缓存什么的都没有用，看来只能等写完这份文档后试试“重启大法”了。

## 已实现的功能 ##

 - 基于Shiro的用户认证和权限管理
 - 文章的展示
 - 略显单薄，再凑一行，over
 


----------


 目前都算是处于踩坑阶段吧，不过可喜的是大概框架是搭建起来了，接下来需要做的就是花时间填充新功能就行了，有空回来继续填坑。

  [1]: http://www.xinshenwoyaoxue.com:9000/html/index.html